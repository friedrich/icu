<html>

<head>
<title>Transliteration Demo</title>
<style type="text/css">
.wide    { width: 100% }
textarea { font-family: Arial Unicode MS; font-size: 100% }
</style>
</head>

<body>
<font face="arial,helvetica,sanserif">

<script src="../js/util.js"></script>

<script>
// Load available IDs from CGI and populate select elems
AVAILABLE_IDS = "$AVAILABLE_IDS".split(";");

// Generate options (inline) for a SELECT element
function generateSelectIDOptions(i) {
  var o = (i==1) ? ['(Compound)'] : ['(Compound)','(Inverse)'];
  generateOptions(o.concat(AVAILABLE_IDS),
                  document.FORM["_SELECT_ID_SELECTION"+i].value);
}
</script>

<!--
<form method="POST" action="/developerworks/opensource/icu/translitdemo" name="FORM">
<form method="POST" action="/cgi-bin/translit" name="FORM">
-->
<form method="POST" action="/cgi-bin/translit" name="FORM">
  <input type="hidden" name="TEMPLATE_FILE" value="data/translit_template.html">
  <input type="hidden" name="ARG_ID">
  <input type="hidden" name="ARG_ID2">
  <input type="hidden" name="ARG_DIRECTION2">
  <input type="hidden" name="_SELECT_ID_SELECTION1" value="$_SELECT_ID_SELECTION1">
  <input type="hidden" name="_SELECT_ID_SELECTION2" value="$_SELECT_ID_SELECTION2">

  <table width="100%">
    <tr>
      <td width="20%">
      <a href="http://www.unicode.org/unicode/standard/WhatIsUnicode.html" target="_blank">Samples</a>
      <a href="http://www.unhchr.ch/udhr/navigate/alpha.htm" target="_blank">Samples2</a>
</td>
      <td width="60%" align="center"><strong><big><big><big>Transliteration Demo</big></big></big></strong><br>
<font size="-1">Running on ICU <b>$ICU_VERSION</b></font></td>
      <td width="20%" align="right">
      <a href=http://oss.software.ibm.com/icu/demo/translit_help.html target="_blank">Help</a>
      </td>
    </tr>
  </table>
  <hr>
  <table width="100%">
    <tr>
      <td width="34%" align="center"><strong><big>Input</strong></td>
      <td width="33%" align="center"><strong><big>Output 1</strong></td>
      <td width="33%" align="center"><strong><big>Output 2</big></strong></td>
    </tr>
    <tr>
      <td><input type="submit" value="Transliterate" name="SUBMIT"
           onclick="handleTransliterateButton()" class="wide">
          </td>
      <td><select name="SELECT_ID1" size="1"
           onChange="handleSelectID(1)" class="wide">
          <script>generateSelectIDOptions(1);</script>
      </select></td>
      <td><select name="SELECT_ID2" size="1"
           onChange="handleSelectID(2)" class="wide">
          <script>generateSelectIDOptions(2);</script>
      </select></td>
    </tr>
    <tr>
	  <td>
      <input type="button" value="Edit Rules" name="NEW"
       onclick="handleEditRules();" class="wide">
      </td>
      <td rowspan="2"><textarea rows="2" name="COMPOUND_ID1" class="wide"
           onKeyPress="handleCompoundIDKeyPress(1)">$COMPOUND_ID1</textarea>
      </td>
      <td rowspan="2"><textarea rows="2" name="COMPOUND_ID2" class="wide"
           onKeyPress="handleCompoundIDKeyPress(2)">$COMPOUND_ID2</textarea>
      </td>
    </tr>
    <tr>
      <td><input type="button" value="Insert Samples" name="SAMPLES"
           onclick="handleInsertSamples()" class="wide">
      </td>
    </tr>
    <tr>
      <td><textarea rows="16" name="ARG_INPUT" class="wide">$ARG_INPUT</textarea></td>
      <td><textarea rows="16" name="OUTPUT1" readonly class="wide">$OUTPUT1</textarea></td>
      <td><textarea rows="16" name="OUTPUT2" readonly class="wide">$OUTPUT2</textarea></td>
    </tr>
  </table>
</form>
</font>

<script>

// Set things up for form submission.  This is invoked
// by either the Transliterate button or by the SELECT id elements.
// The argument is either 1 or 2 for the SELECT id elements,
// or something else for the Transliterate button.
function _submit(i) {
  var id1 = getSelectedOption(document.FORM.SELECT_ID1);
  var id2 = getSelectedOption(document.FORM.SELECT_ID2);
  if (id1 == '(Compound)') {
    if (i==1) return; // Ignore selection of (Compound)
    id1 = document.FORM.COMPOUND_ID1.value;
  }
  if (id2 == '(Compound)') {
    if (i==2) return; // Ignore selection of (Compound)
    id2 = document.FORM.COMPOUND_ID2.value;
  }
  document.FORM._SELECT_ID_SELECTION1.value = id1;
  document.FORM._SELECT_ID_SELECTION2.value = id2;
  var isInverse = (id2 == '(Inverse)');
  document.FORM.ARG_ID.value = id1;
  document.FORM.ARG_ID2.value = isInverse ? id1 : id2;
  document.FORM.ARG_DIRECTION2.value = isInverse ? "REVERSE" : "";
  document.FORM.submit();
}

// Handler for a change to a transliterator ID box.
function handleSelectID(i) {
  _submit(i);
}

// Handler for Transliterate button
function handleTransliterateButton() {
  _submit(-1);
}

// Handler for compound type-in box.  This handler switches
// the corresponding pop-up box to "(Compound)".
// This is assumed to be the index 0 item for pop-up 1, and
// the index 1 item for pop-up 2.
function handleCompoundIDKeyPress(i) {
  x = document.FORM["SELECT_ID" + i];
  x.selectedIndex = 0;
}

// Handler to insert some sample text into the INPUT area
// and set up the COMPOUND_ID_x boxes.
function handleInsertSamples() {
  x = document.FORM.ARG_INPUT;
  x.value =
    "\uae40, \uad6d\uc0bc\n"+
    "\uc774, \uae30\uc218\n"+
    "\uae40, \uba85\ud76c\n"+
    "\uc774, \ud61c\ubbfc\n"+
    "\uac15, \uc815\ub2d8\n"+
    "\uc815, \ubcd1\ud638\n"+
    "\u305f\u3051\u3060, \u307e\u3055\u3086\u304d\n"+
    "\u307e\u3059\u3060, \u3088\u3057\u3072\u3053\n"+
    "\u3084\u307e\u3082\u3068, \u306e\u307c\u308b\n"+
    "\u304a\u304a\u306f\u3089, \u307e\u306a\u3076\n"+
    "\u3075\u306a\u3064, \u304b\u305a\u3072\u3053\n"+
    "\u305f\u3058\u308a, \u307f\u306d\u306f\u308b\n"+
    "\u3064\u3060, \u305f\u304b\u3057\n"+
    "\u306a\u304c\u304a, \u3068\u3082\u307f\n"+
    "\u304a\u304a\u3059\u304e, \u3072\u308d\u3086\u304d\n"+
    "\u041a\u043e\u0440\u043d\u0438\u043b\u044c\u0435\u0432, \u041a\u0438\u0440\u0438\u043b\u043b\n"+
    "\u0410\u0440\u0431\u0430\u0442\u043e\u0432, \u0413\u0435\u043e\u0440\u0433\u0438\u0439\n"+
    "\u041a\u043e\u0432\u0430\u043b\u0435\u0432, \u041d\u0438\u043a\u043e\u043b\u0430\u0439\n"+
    "\u0413\u043e\u0440\u0431\u0430\u0447\u0435\u0432, \u041c\u0438\u0445\u0430\u0438\u043b\n"+
    "\u0410\u0440\u0431\u0443\u0437\u043e\u0432, \u041c\u0438\u0445\u0430\u0438\u043b\n"+
    "\u041a\u043e\u0437\u044b\u0440\u0435\u0432, \u0410\u043d\u0434\u0440\u0435\u0439\n"+
    "\u0414\u0443\u0431\u0440\u043e\u0432\u0438\u043d\u0430, \u0415\u043b\u0435\u043d\u0430\n"+
    "\u041a\u0430\u0437\u0430\u043a\u043e\u0432\u0430, \u0420\u0438\u043c\u043c\u0430\n"+
    "\u0424\u0435\u0434\u043e\u0440\u043e\u0432, \u0411\u043e\u0440\u0438\u0441\n"+
    "\u041d\u0435\u043c\u0446\u043e\u0432, \u0411\u043e\u0440\u0438\u0441\n"+
    "\u0414\u043e\u0433\u0438\u043b\u0435\u0432\u0430, \u0422\u0430\u0442\u044c\u044f\u043d\u0430\n"+
    "\u039a\u03b1\u03c6\u03b5\u03c4\u03b6\u03cc\u03c0\u03bf\u03c5\u03bb\u03bf\u03c2, \u0398\u03b5\u03cc\u03c6\u03b9\u03bb\u03bf\u03c2\n"+
    "\u03a1\u03bf\u03cd\u03c4\u03c3\u03b7, \u0386\u03bd\u03bd\u03b1\n"+
    "\u039a\u03b1\u03bb\u03bf\u03cd\u03b4\u03b7\u03c2, \u03a7\u03c1\u03ae\u03c3\u03c4\u03bf\u03c2\n"+
    "\u039b\u03af\u03bd\u03c4\u03c7\u03bf\u03c1\u03c3\u03c4, \u0391\u03bd\u03c4\u03ce\u03bd\u03b9\n"+
    "\u0398\u03b5\u03bf\u03b4\u03c9\u03c1\u03ac\u03c4\u03bf\u03c5, \u0395\u03bb\u03ad\u03bd\u03b7\n"+
    "\u039d\u03b1\u03b4\u03ac\u03bb\u03b7\u03c2, \u039a\u03ce\u03c3\u03c4\u03b1\u03c2\n"+
    "\u039a\u03b9\u03b1\u03c0\u03b5\u03ba\u03ac\u03ba\u03b7, \u03a7\u03b1\u03c1\u03ac\n"+
    "\u039a\u03bf\u03bd\u03c4\u03bf\u03b3\u03b9\u03b1\u03bd\u03bd\u03ac\u03c4\u03bf\u03c2, \u0392\u03b1\u03c3\u03af\u03bb\u03b7\u03c2";

  document.FORM.OUTPUT1.value = "(Press the Transliterate button to see results.)";
  document.FORM.SELECT_ID1.selectedIndex = 0; // (Compound)
  document.FORM.COMPOUND_ID1.value =
    "Hangul-Latin; Kana-Latin; Cyrillic-Latin; Greek-Latin; Any-Title";

  document.FORM.OUTPUT2.value = "";
  document.FORM.SELECT_ID2.selectedIndex = 0; // (Compound)
  document.FORM.COMPOUND_ID2.value =
    "Latin-Greek";
}

// Handler for Edit Rules button
function handleEditRules() {
  _getEditor().focus();
  //document.FORM.IS_EDITOR_OPEN.value = "1";
}

// Return the editor window
function _getEditor() {
  return open("/cgi-bin/translit?TEMPLATE_FILE=data/translit_rule_edit.html",
              "_TRANSLIT_EDIT");
              //"menubar,resizable,scrollbars");
}

//=// Handler that gets called by the rule editing window when the user
//=// wants to submit the new rules
//=function submitRules(ruleWindow) {
//=  // The custom rule data consists of an ID and rule text.
//=  // We'll copy these to our form, add an entry to the TRANSLITERATOR_ID_1
//=  // and TRANSLITERATOR_ID_2 selectors, and select that item in both.
//=  // TODO -- clean up this logic
//=  var f = document.FORM;
//=  var id = f.USER_RULE_ID.value = ruleWindow.FORM.ID.value;
//=  f.USER_RULE.value = ruleWindow.FORM.RULES.value;
//=
//=  f.COMPOUND_ID_1.value = id;
//=  f.TRANSLITERATOR_ID_1.selectedIndex = 0; // Compound
//=
//=  f.EDIT_MODE.value = "1"; // Flag that we have rules now
//=
//=  // Put a helpful message in the Output 1 text area
//=  f.OUTPUT_1.value =
//=    "(CustomRules transliterator loaded.  To see results, modify the " +
//=    "compound ID, if desired, then press the Transliterate " +
//=    "button.)"
//=
//=  // Clear the second output area
//=  f.OUTPUT_2.value = "";
//=
//=  // If the second transliterator is "(Inverse)" then set it to Null,
//=  // since we don't support inverses of the custom transliterator yet.
//=  if (f.TRANSLITERATOR_ID_2.selectedIndex == 0) {
//=    var o = f.TRANSLITERATOR_ID_2.options;
//=    for (i=2; i<o.length; ++i) {
//=      if (o[i].text == "Null") {
//=        f.TRANSLITERATOR_ID_2.selectedIndex = i;
//=        break;
//=      }
//=    }
//=  }
//=
//=  window.focus();
//=}
</script>

</body>
</html>
